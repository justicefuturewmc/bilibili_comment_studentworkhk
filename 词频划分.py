import pandas as pd
import jieba
from collections import Counter
import re

# 简单版本的词频分析
def simple_word_freq_analysis(file_path, comment_column='comment'):
    # 读取数据
    df = pd.read_csv("C:/Users/86131/Desktop/5507/bilibili_comments_reply.csv")

    stopwords = {
        # 基础停用词
        '就', '都', '也', '还', '又', '再', '很', '最', '太', '更', '挺', '较', '极', '超',
        '只', '仅', '光', '单', '净', '唯', '独', '专', '特', '别', '另', '另', '各',
        '每', '各', '某', '每', '各', '某', '本', '该', '此', '此', '此', '此', '此',
        '其', '之', '者', '所', '而', '且', '并', '并', '且', '而', '或', '或者', '或者',
        
        # 网络语气词
        '呐', '呢', '吗', '嘛', '吧', '啊', '呀', '哇', '啦', '诶', '欸', '喔', '噢',
        '呵', '嘿', '嘻', '噗', '哧', '嗤', '嘘', '嘶', '嗯', '唔', '哼', '咳', '唉',
        '哎', '嗨', '哟', '呦', '呜', '呼', '哈', '吼', '嗷', '嘤', '嘁', '啧', '嗞',
 
        # 代词类
        '我的', '你的', '他的', '她的', '它的', '我们的', '你们的', '他们的', '她们的', '它们的',
        '自己', '自身', '本人', '本身', '个人', '人家', '别人', '他人', '大伙', '大家', '各位',
        '这个', '那个', '这些', '那些', '这种', '那种', '这类', '那类', '这边', '那边', '这里',
        '那里', '这儿', '那儿', '这样', '那样', '这么', '那么', '怎样', '如何', '为啥', '为何',
        '什么', '啥子', '哪些', '哪个', '哪儿', '哪里', '多少', '几个', '若干', '一些', '一点',
        '我', '你', '他', '她', '它', '我们', '你们', '他们', '她们', '它们', '自己', '人家', 
        '大家', '谁', '什么', '哪', '哪里', '怎么', '怎样', '多少', '几', '这个', '那个', '这些', 
        '那些', '这里', '那里', '这样', '那样', '每个', '这次', '一次', '一种', '其他', '这是',
        
        # 连词
        '和', '与', '及', '或', '或者', '而且', '但是', '虽然', '尽管', '如果', '假如', 
        '因为', '所以', '因此', '于是', '然后', '那么', '不仅', '不但',
            
        # 介词
        '在', '于', '从', '自', '往', '向', '到', '对', '对于', '关于', '至于', '沿着', 
        '顺着', '按照', '根据', '通过', '由于', '为了', '为', '除了',
            
        # 助词
        '的', '地', '得', '了', '着', '过', '吧', '吗', '呢', '啊', '呀', '哇', '啦', 
        '嘛', '呗', '罢了', '而已', '的话', '来说', '来讲', '来看',
            
        # 副词
        '很', '非常', '特别', '极其', '最', '太', '更', '更加', '越', '都', '也', '就', 
        '才', '还', '再', '又', '已经', '曾经', '刚刚', '正在', '将要', '总是', '经常', 
        '通常', '偶尔', '从不', '没有', '不', '别', '勿', '是否', '还是', '还有', '只有',
        '只能', '只要', '其实', '一直',

        # 动词（无意义）
        '是', '有', '没有', '无', '做', '作', '进行', '开始', '结束', '完成', '实现', 
        '成为', '变成', '觉得', '认为', '想', '思考', '知道', '了解', '理解', '认识',
        '看看', '需要',
            
        # 方位词
        '上', '下', '左', '右', '前', '后', '里', '外', '中', '内', '间', '旁',
            
        # 数量词
        '一', '二', '三', '四', '五', '六', '七', '八', '九', '十', '百', '千', '万', 
        '亿', '个', '只', '条', '件', '种', '类', '些', '点', '部分', '全部', '整个',
        '全面', '有点', '所有',
            
        # 时间词
        '现在', '过去', '未来', '今天', '明天', '昨天', '今年', '明年', '去年', '时候', 
        '时间', '时期', '时代', '时刻', '分钟', '小时', '天', '周', '月', '年', '一年',
        '当时', '最后', '以后',
            
        # 常用但无意义
        '就是', '可以', '可能', '应该', '一定', '肯定', '确实', '实在', '真的', '真是', 
        '好像', '似乎', '大概', '大约', '几乎', '差不多', '左右', '上下', '一样', '一下',
        '不到', '真正', '不了', '不同', '起来', '一起', '出来',

        # 动词类
        '是的', '不是', '有没有', '会不会', '能不能', '可不可以', '要不要', '想不想', '愿不愿意',
        '觉得', '感觉', '感到', '以为', '认为', '认知', '知道', '了解', '理解', '明白', '懂得',
        '看到', '看见', '听到', '听见', '闻到', '嗅到', '尝到', '摸到', '碰到', '遇到', '遭到',
        '开始', '开工', '开局', '开头', '起步', '启动', '起始', '开端', '起源', '开头', '开端',
        '结束', '完结', '完了', '完毕', '终结', '终止', '终点', '收官', '收尾', '结尾', '结局',
        '进行', '举行', '开展', '展开', '实施', '实行', '执行', '推行', '推进', '推动', '促进',
        
        # 副词类
        '非常', '特别', '极其', '极度', '极端', '十分', '相当', '挺很', '颇为', '较为', '比较',
        '更加', '更为', '越发', '愈加', '愈益', '格外', '分外', '特别', '异常', '异乎', '超常',
        '确实', '实在', '真的', '真是', '真挺', '真很', '真太', '真极', '真超', '真特', '真颇',
        '可能', '也许', '或许', '或者', '兴许', '大概', '大约', '约莫', '貌似', '似乎', '好像',
        '一定', '必定', '必然', '肯定', '确定', '确凿', '无疑', '毫无疑问', '绝对', '完全', '第一',
        '已经', '早已', '早就', '先前', '以前', '之前', '从前', '过往', '过去', '昔日', '往昔',
        '正在', '正忙', '正处', '正值', '正当', '正巧', '正好', '恰好', '刚好', '恰恰', '正好',
        
        # 连词介词
        '因为', '所以', '因此', '因而', '于是', '那么', '然后', '接着', '接下来', '随后', '后来',
        '但是', '可是', '然而', '不过', '只是', '却是', '反倒是', '反而是', '偏偏是', '仅仅是',
        '如果', '假如', '假设', '倘若', '要是', '若是', '万一', '一旦', '既然', '既是', '既是',
        '虽然', '尽管', '即使', '哪怕', '纵然', '就算', '即令', '即或', '即若', '即便', '即算',
        '为了', '为着', '因为', '由于', '鉴于', '基于', '根据', '依据', '按照', '遵照', '依照',
        '关于', '对于', '对待', '针对', '冲着', '朝着', '向着', '对着', '当着', '趁着', '趁着',
        '原来', '终于', '本来', '结果', '甚至', '毕竟',
        
        # 助词语气
        '的了', '着呢', '了吗', '的吧', '啊呀', '啊哈', '哎呀', '哎哟', '哦呵', '喔唷', '哇塞',
        '哈哈', '呵呵', '嘿嘿', '嘻嘻', '哼哼', '咳咳', '啧啧', '嘘嘘', '呼呼', '哧哧', '嗤嗤',
        '啊啊', '呀呀', '哇哇', '呜呜', '嘤嘤', '嗷嗷', '喵喵', '汪汪', '嘎嘎', '叽叽', '喳喳',
        
        # 方位时间
        '上面', '下面', '左边', '右边', '前面', '后面', '里面', '外面', '中间', '中央', '中心',
        '旁边', '附近', '周围', '四周', '周边', '邻近', '临近', '贴近', '靠近', '挨着', '接着',
        '之前', '之后', '之上', '之下', '之前', '之后', '之内', '之外', '之间', '之中', '之侧',
        '今天', '明天', '昨天', '前天', '后天', '上午', '下午', '晚上', '早晨', '清晨', '黄昏',
        '时候', '时间', '时刻', '时分', '时节', '时期', '时代', '年代', '年月', '日期', '天数',
        
        # 数量程度
        '一个', '两个', '三个', '四个', '五个', '六个', '七个', '八个', '九个', '十个', '多个',
        '一些', '一点', '一批', '一群', '一套', '一组', '一对', '一双', '一副', '一件', '一条',
        '很多', '许多', '大量', '大批', '众多', '繁多', '诸多', '无数', '无穷', '无尽', '无限',
        '少量', '少许', '不多', '不多', '不多', '不多', '不多', '不多', '不多', '不多', '不多',
        '全部', '全体', '整体', '整个', '全部', '全体', '整体', '整个', '全部', '全体', '整体',
        
        # 网络用语
        '卧槽', '我靠', '我去', '天了', '妈呀', '上帝', '老天', '天呐', '救命', '帮帮', '求助',
        '哈哈', '呵呵', '嘿嘿', '嘻嘻', '啊啊', '哇哇', '呜呜', '嘤嘤', '嗷嗷', '喵喵', '汪汪',
        '真的', '确实', '实在', '真挺', '真很', '真太', '真极', '真超', '真特', '真颇', '真颇',
        '好的', '可以', '不错', '还行', '挺好', '很好', '非常好', '特别好', '极好', '超好', '绝好',
        '不好', '不行', '不能', '不要', '不可', '不该', '不愿', '不想', '不会', '不懂', '不知',
        
        # B站特定
        '弹幕', '评论', '视频', 'up主', '主播', '直播', '硬币', '点赞', '投币', '收藏', '转发',
        '分享', '关注', '粉丝', '三连', '素质', '一键', '感谢', '谢谢', '多谢', '感恩', '感激',
        '前排', '沙发', '板凳', '地板', '地下', '高能', '预警', '注意', '前方', '打卡', '签到',
        '冒泡', '路过', '围观', '催更', '更新', '下期', '期待', '爱了', '可以', '不错', '很好',
        '居然', '看着', '稍后', '到底', '再试', '我要', '终末', '小钟', '小国', '突然', '假一',
        '不用', '不如', '当然', '基本', '一般', '情况', '主要', '你好', '意思', '直接', '东西',
        'up', '有人',
        }
    
    all_words = []
    
    for comment in df[comment_column]:
        if pd.isna(comment):
            continue
            
        # 清洗文本
        text = re.sub(r'[^\w\s\u4e00-\u9fff]', '', str(comment))
        text = re.sub(r'\d+', '', text)
        
        # 分词
        words = jieba.cut(text)
        words = [word for word in words if word not in stopwords and len(word) > 1 and len(word) < 3]
        all_words.extend(words)
    
    # 统计词频
    word_freq = Counter(all_words)
    
    # 输出前50个高频词
    print("前50个高频词:")
    for word, freq in word_freq.most_common(50):
        print(f"{word}: {freq}")
    
    return word_freq

# 使用示例
if __name__ == "__main__":
    result = simple_word_freq_analysis('bilibili_comments.csv')